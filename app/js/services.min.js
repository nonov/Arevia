"use strict";var areviaServices=angular.module("areviaServices",["ngResource"]);areviaServices.factory("NewsletterService",["$http",function(e){var r={};return r.post=function(r){return e.post("/Arevia/RESTapi/public/api/newsletter",r)},r}]),areviaServices.factory("MailService",["$http",function(e){var r={};return r.post=function(r){return e.post("/Arevia/RESTapi/public/api/mail",r)},r}]),areviaServices.factory("PostsService",["$http",function(e){var r={};return r.post=function(r){return e.post("/Arevia/RESTapi/public/api/post",r)},r.get=function(r){return e.get("/Arevia/RESTapi/public/api/post/"+r).then(function(e){return e.data})},r.delete=function(r){return e.delete("/Arevia/RESTapi/public/api/post/"+r).then(function(e){return e.data})},r}]),areviaServices.factory("AuthService",["$http","Session","$rootScope",function(e,r,t){var n={};return n.login=function(t){return e.post("/Arevia/RESTapi/public/user/login",t).then(function(e){return r.create(e.data.id,e.data.user.id,e.data.user.login),e.data.user})},n.logout=function(){return e.get("/Arevia/RESTapi/public/user/logout").then(function(){t.currentUser=null,r.destroy()})},n.isAuthenticated=function(){return!!r.userId},n.retrieveUser=function(){return e.get("/Arevia/RESTapi/public/api/user").then(function(e){return"0"!==e.data?(r.create(e.data.id,e.data.user.id,e.data.user.role),e.data.user):null},function(){return null})},n}]),areviaServices.factory("FileService",["$http","$rootScope","$upload",function(e,r,t){var n={};return n.update=function(e,r){var n=[];if(e&&e.length)for(var i=0;i<e.length;i++){var a=e[i],u=t.upload({url:r,headers:{nom:a.name},file:a}).progress(function(e){parseInt(100*e.loaded/e.total)}).success(function(e){return e});n.push(u)}return n},n.delete=function(r){return e.delete("/Arevia/RESTapi/public/api/file/"+r).then(function(e){return e.data})},n}]),areviaServices.factory("ArticleService",["$http","$rootScope",function(e){var r={};return r.get=function(){return e.get("/Arevia/RESTapi/public/api/article").then(function(e){return e.data})},r.post=function(r){return e.post("/Arevia/RESTapi/public/api/article",r)},r.delete=function(r){return e.delete("/Arevia/RESTapi/public/api/article/"+r).then(function(e){return e.data})},r}]),areviaServices.factory("Session",function(){var e={};return e.create=function(r,t,n){e.id=r,e.userId=t,e.userLogin=n},e.destroy=function(){e.id=null,e.userId=null,e.userLogin=null},e}),areviaServices.factory("AuthInterceptor",["$rootScope","$q","AUTH_EVENTS","FILE_EVENTS","ARTICLE_EVENTS","POSTS_EVENTS","MAIL_EVENTS",function(e,r,t,n,i,a,u){return{responseError:function(o){return e.$broadcast({401:t.notAuthenticated,403:t.notAuthorized,419:t.sessionTimeout,440:t.sessionTimeout,441:n.uploadFailed,442:n.getFailed,450:i.postFailed,451:i.selectFailed,452:i.deleteFailed,460:a.postFailed,461:a.deleteFailed,470:u.sendFailed}[o.status],o),r.reject(o)}}}]),areviaServices.factory("AuthResolver",["$q","$rootScope","$location",function(e,r,t){return{resolve:function(n,i){var a=e.defer(),u=r.$watch("currentUser",function(e){angular.isDefined(e)&&(e?(a.resolve(e),angular.isString(n)&&t.path(n)):angular.isString(i)?(a.reject(),t.path(i)):i?t.path("/"):a.resolve(),u())});return a.promise}}}]),areviaServices.factory("SessionResolver",["$q","$rootScope","$location","Session",function(e,r){return{resolve:function(){var t=e.defer();return r.deferred.promise.then(function(){return t.resolve(),r.$broadcast("$routeChangeStart"),t.promise})}}}]);